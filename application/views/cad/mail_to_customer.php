<div class="dialog_con1">    <div class="row">        <div class="col-lg-12">            <form class="form-horizontal" id="approval_mail" action="<?php echo base_url('cad/cad_mail_to_customer'); ?>" method="post">                <div class="form-group"> <label class="col-sm-2 control-label">To</label> <div class="col-sm-10">                        <input type="hidden" name="ord_id" id="ord_id" value="<?php echo $ord_id; ?>">                        <input type="email" name="email" class="form-control" id="email" readonly="readonly" value="<?php echo $customer['eng_email']; ?>"> </div> </div>                <div class="form-group"> <label class="col-sm-2 control-label">Cc</label> <div class="col-sm-10">                        <input value="<?php echo $customer['eng_adi_email']; ?>" type="text" name="cc_email" class="form-control" id="cc_email"> </div> </div>                <div class="form-group"> <label class="col-sm-2 control-label">Attachments</label>                    <div class="col-sm-10">                         <input type="file" name="attachment" id="attachfile" class="attachment form-control">                        <!--input type="button" value="Browse" id="clickme" onclick="uploadFile()"/-->                    </div>                </div>                <input type="hidden" name="file_names" id="file_names">                <div class="form-group">                    <label class="col-sm-2 control-label"></label>                       <div class="col-sm-10">                           <progress id="progressBar" value="0" max="100" style="width:300px;"></progress>                        <div class="" id="">                            <ul id="images_ul">                            </ul>                        </div>                    </div>                </div><?php $data = get_cad_mail_subject(); ?>                <div class="form-group">                    <label class="col-sm-2 control-label">Subject</label>                    <div class="col-sm-10">                         <select type="text" class="form-control" name="subject" id="subject">                            <option selected="selected">---------- Select Subject ----------</option>                            <?php foreach ($data as $subject) { ?>                                <option class="cad_mail_subject" data-mail-id="<?php echo $subject['mail_id']; ?>" data-engg-id="<?php echo $customer['eng_id']; ?>" data-order-id="<?php echo $ord_id; ?>" value="<?php echo $subject['mail_subject']; ?>">                                    <?php echo $subject['mail_subject']; ?>                                </option>                            <?php } ?>                        </select></div> </div>                <div class="form-group">                    <label class="col-sm-2 control-label">                        Message                    </label>                    <div class="col-sm-10">                         <textarea class="ckeditor form-control" id="mail_message" name="message">                        </textarea>                    </div>                 </div>                <div class="form-group">                    <label class="col-sm-2 control-label">                    </label>                    <div class="col-sm-10">                        <button class="btn btn-primary" type="submit">                            Send                        </button>                    </div>                 </div>            </form>        </div>    </div></div><?php $Url = base_url() . 'cad/upload_attachment'; ?><script>//jQuery.noConflict();//    $(function ($) {        $("#attachfile").on("change", function () {            uploadFile()        }); // You should remove (jQuery) because you don't want to call the function here    });    function _(el) {        return document.getElementById(el);    }    function uploadFile() {        var file = _("attachfile").files[0];        // alert(file.name+" | "+file.size+" | "+file.type);        var formdata = new FormData();        formdata.append("file1", file);        var ajax = new XMLHttpRequest();        ajax.upload.addEventListener("progress", progressHandler, false);        ajax.addEventListener("load", completeHandler, false);        ajax.addEventListener("error", errorHandler, false);        ajax.addEventListener("abort", abortHandler, false);        ajax.open("POST", "<?php echo $Url; ?>");        ajax.send(formdata);    }    function progressHandler(event) {        //_("loaded_n_total").innerHTML = "Uploaded " + event.loaded + " bytes of " + event.total;        var percent = (event.loaded / event.total) * 100;        _("progressBar").value = Math.round(percent);//        _("status").innerHTML = Math.round(percent) + "% uploaded... please wait";    }    function completeHandler(event) {        var response = event.target.responseText;        var res = JSON.parse(response);        var newlink = document.createElement('a');        newlink.appendChild(document.createTextNode('x'));        newlink.setAttribute('class', 'delete-files');        newlink.setAttribute('file_name', res.savedfilename);        var node = document.createElement("LI");                 // Create a <li> node        var textnode = document.createTextNode(res.filename);         // Create a text node        node.appendChild(textnode);        node.appendChild(newlink);                              // Append the text to <li>        document.getElementById("images_ul").appendChild(node);//        _("images_ul").appendChild(node);        $("#file_names").val($("#file_names").val() + res.savedfilename + ",");        _("progressBar").value = 0;    }    function errorHandler(event) {        _("status").innerHTML = "Upload Failed";    }    function abortHandler(event) {        _("status").innerHTML = "Upload Aborted";    }//    $(document).ready(function () {//        $('body').append('<textarea id="mail_message" />');//        CKEDITOR.replace('mail_message');//    });        $(document).ready(function () {       $(".delete-files").unbind("click");        $("body").on("click", ".delete-files", function () {            var file_name = $(this).attr("file_name");            var textboxval = $("#file_names").val();            textboxval = textboxval.replace(file_name + ',', '');            textboxval = textboxval.replace(',' + file_name, '');            textboxval = textboxval.replace(file_name, '');            $("#file_names").val(textboxval);            $(this).parent('li').remove();        });        /**         * Cad Mailing Subject         */        $("body").on("click", ".cad_mail_subject", function (e) {            e.preventDefault();            var ord_id = $(this).attr("data-order-id");            var eng_id = $(this).attr("data-engg-id");            var mail_id = $(this).attr("data-mail-id");            $.ajax({                url: "<?php echo base_url('cad/get_mail_subject'); ?>",                data: {ord_id: ord_id, eng_id: eng_id, mail_id: mail_id},                type: "POST",                success: function (response) {                    $('#mail_message').html(response);                }            })        });        $("#approval_mail").submit(function (event) {            /* stop form from submitting normally */            event.preventDefault();            /* get some values from elements on the page: */            var $form = $(this),                    url = $form.attr('action');            /* Send the data using post */            var posting = $.post(url, {ord_id: $('#ord_id').val(), email: $('#email').val(), cc_email: $('#cc_email').val(),                file_names: $('#file_names').val(), subject: $('#subject').val(), message: $('#mail_message').val()});            /* Alerts the results */            posting.done(function (response) {                var res = JSON.parse(response);                if(res.status) {                $('#mail_box').dialog('close');                $('#cad_dialog_box').dialog('close');                $(".wrapper").load(location.href + " .wrapper");                show_notification_message(res.message, "success");                }else {                   show_notification_message(res.message, "error");                }            });        });    });</script>